<element name="rebound-demo">
	<template>

		<link href="/test/demo/templates/components/editing.html">

		<section id="todoapp">
			<header id="header">
				<h1>todos</h1>
		    <input id="new-todo" type="text" placeholder="What needs to be done?" value="{{newTitle}}" rebound-action="createTodo">
			</header>

		  {{#if todos}}
				<section id="main">
					<ul id="todo-list">
						{{#each filteredTodos}}
							<li class="{{if isCompleted "completed"}} {{if editing "editing"}}">
								{{#if editing}}
		              <edit-todo value={{title}} editing={{editing}} arr={{arr}} obj={{obj}}>asdf</edit-todo>
								{{else}}
									<input type="checkbox" class="toggle" checked="{{isCompleted}}">
									<label {{on "dblclick" "editTodo" }}>{{title}}</label>
									<button {{on "click" "removeTodo"}} class="destroy"></button>
								{{/if}}
								</li>
						{{/each}}
					</ul>
					<input type="checkbox" id="toggle-all" checked={{allAreDone}} {{on 'click' 'toggleAll'}}>
				</section>
				<footer id="footer">
					<span id="todo-count"><strong>{{remaining}}</strong> item left</span>
					<ul id="filters">
						<li>
							<a href="/all" class="selected" >All</a>
						</li>
						<li>
							<a href="/active" >Active</a>
						</li>
						<li>
		          <a href="/completed">Completed</a>
						</li>
					</ul>
					{{#unless noneAreDone}}
						<button id="clear-completed" {{on "click" "clearCompleted"}}>
							Clear completed ({{completed}})
						</button>
					{{/unless}}
				</footer>
		  {{/if}}
		</section>
		<footer id="info">
			<p>Double-click to edit a todo</p>
			<p>
				Created by
				<a href="http://github.com/epicmiller">Adam Miller</a>,
			</p>
			<p>Part of <a href="http://todomvc.com">TodoMVC</a></p>
		</footer>
	</template>
</element>
<script>
	return ({

	/**************** Component Configs *******************/


	/*************** Lifecycle Functions ******************/

		initialize: function(options){

		},
		createdCallback: function(){
			window.el = this;
		},
		attachedCallback: function(){

		},
		detachedCallback: function(){

		},
		routes: {
			":filter" : "filterList"
		},

	/************** Controller Properties *****************/
		newTitle: '',
		filter: 'all',
		todos: [
			{
				title: "Tie Bowtie",
				editing: false,
				isCompleted: true
			},{
				title: "Look Dapper",
				editing: false,
				isCompleted: false,
				obj: {e:1, f:2}
			},{
				title: "Profit",
				editing: false,
				isCompleted: false,
				arr: [{a: 1}, {b: 2}, {c: 3}]
			}
		],
	/************** Computed Properties *****************/
		allAreDone: function(){
			return this.get('todos').where({'isCompleted': true}).length == this.get('filteredTodos').length;
		},
		noneAreDone: function(){
			return this.get('todos').where({'isCompleted': true}).length == 0;
		},
		remaining: function(){
			return this.get('todos').where({'isCompleted': false}).length;
		},
		completed: function(){
			return this.get('todos').where({'isCompleted': true}).length;
		},
		filteredTodos: function(){
			if(this.get('filter') == 'all')
				return this.get('todos');
			if(this.get('filter') == 'active')
				return this.get('todos').where({'isCompleted': false});
			if(this.get('filter') == 'completed')
				return this.get('todos').where({'isCompleted': true});
		},

	/************** Controller Methods *****************/

		createTodo: function(event){
			if(this.get('newTitle') == '') return;
			this.get('todos').add({
				title: this.get('newTitle'),
				editing: false,
				isCompleted: false
			});
			this.set('newTitle', '');
		},
		toggleAll: function(event){
			var value = event.currentTarget.checked;
			this.get('todos').forEach(function(model, index) {
				model.set('isCompleted', value);
			});
		},
		clearCompleted: function(event){
			this.get('todos').remove(
				this.get('todos').where({'isCompleted': true})
			);
		},
		removeTodo: function(event){
			this.get('todos').remove(event.data);
		},
		editTodo: function(event){
			event.data.set('editing', true);
		},
		filterList: function(filter){
			this.set('filter', filter)
		}
	});
</script>