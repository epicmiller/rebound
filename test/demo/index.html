<html>
  <head>
    <script src="../../dist/rebound.compiler.pkg.js" ></script>
    <script src="./templates/_editing.js" ></script>
    <script src="./templates/demo.js" ></script>
    <link rel="stylesheet" href="/bower_components/todomvc-common/base.css">
    <link rel="stylesheet" type="text/css" id="profile-css" href="./demo.css">
  </head>

  <body>
    <div id="outlet"></div>
  </body>

  <script>
    var toDoModelClass = Backbone.Model.extend({
      initialize: function(){
        console.log("ToDo Model Instantiated", this);
      }
    });

    var toDoModel = new toDoModelClass({
      newTitle: '',
      allAreDone: function(){
        return this.get('filteredTodos').where({'isCompleted': true}).length == this.get('filteredTodos').length;
      },
      remaining: function(){
        return this.get('filteredTodos').where({'isCompleted': false}).length;
      },
      completed: function(){
        return this.get('filteredTodos').where({'isCompleted': true}).length;
      },
      filteredTodos: [
        {
          title: "Tie Bowtie",
          editing: false,
          isCompleted: true
        },{
          title: "Look Dapper",
          editing: false,
          isCompleted: false
        },{
          title: "Profit",
          editing: false,
          isCompleted: false
        }
      ]
    });


    var testControllerClass = Backbone.Controller.extend({
      initialize: function(options){
        console.log("Test Controller Initialized", this);
      },
      createTodo: function(event){
        if(this.data.get('newTitle') == '') return;
        this.data.get('filteredTodos').add({
          title: this.data.get('newTitle'),
          editing: false,
          isCompleted: false
        });
        this.data.set('newTitle', '');
      },
      toggleAll: function(event){
        var value = event.currentTarget.checked;
        this.data.get('filteredTodos').forEach(function(model, index) {
          model.set('isCompleted', value);
        });
      },
      clearCompleted: function(){
        this.data.get('filteredTodos').remove(
          this.data.get('filteredTodos').where({'isCompleted': true})
        );
      },
      removeTodo: function(event){
        this.data.get('filteredTodos').remove(event.data);
      },
      editTodo: function(event){
        event.data.set('editing', true);
      },
      doneEditing: function(event){
        event.data.set('editing', false);
      }
    });

    var testController = new testControllerClass({
      outlet: $('#outlet'),
      data: toDoModel,
      template: template
    });


  </script>


</html>
